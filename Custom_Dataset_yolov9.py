# -*- coding: utf-8 -*-
"""sat_testyolov9.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1aXa4ZqUxIAkeSM5SAZnZ9S-sxb6ziQeU
"""

!nvidia-smi

import torch

# Check PyTorch GPU availability
if torch.cuda.is_available():
    print(f"GPU Name: {torch.cuda.get_device_name(0)}")
    print(f"GPU Is Available: {torch.cuda.is_available()}")
else:
    print("GPU is not available.")

from google.colab import drive
drive.mount('/content/gdrive')

!ln -s /content/gdrive/My\ Drive/ /mydrive

# Commented out IPython magic to ensure Python compatibility.
# %cd /content/gdrive/MyDrive/MLFABRIC/MY_YOLO/yolov9

# Commented out IPython magic to ensure Python compatibility.
# %pwd

!git clone https://github.com/WongKinYiu/yolov9.git

# Commented out IPython magic to ensure Python compatibility.
# %cd yolov9

# Commented out IPython magic to ensure Python compatibility.
# %pwd

!pip install -r requirements.txt

!wget -P /mydrive/yolov9 https://github.com/WongKinYiu/yolov9/releases/download/v0.1/yolov9-c.pt
!wget -P /mydrive/yolov9 https://github.com/WongKinYiu/yolov9/releases/download/v0.1/yolov9-e.pt

!python detect.py --weights /content/gdrive/MyDrive/yolov9/yolov9-e.pt --source /content/gdrive/MyDrive/MLFABRIC/woman-5059062_960_720.jpg  --device 0

from IPython.display import Image

Image(filename=f"/content/gdrive/MyDrive/MLFABRIC/MY YOLO/yolov9/yolov9/runs/detect/exp6/woman-5059062_960_720.jpg", width=1000)

!python detect.py --weights /content/gdrive/MyDrive/yolov9/yolov9-e.pt --source /content/gdrive/MyDrive/MLFABRIC/MY_YOLO/yolov9/test.jpg  --device 0

from IPython.display import Image

Image(filename=f"/content/gdrive/MyDrive/MLFABRIC/MY_YOLO/yolov9/yolov9/runs/detect/exp9/test.jpg", width=1000)

"""# **Training yolov9 on custom dataset**"""

# Commented out IPython magic to ensure Python compatibility.
# %pwd

!python train_dual.py --workers 8 --batch 4  --img 640 --epochs 50 --data /content/gdrive/MyDrive/MLFABRIC/MY_YOLO/yolov9/yolov9/data.yaml --weights /mydrive/yolov9/yolov9-e.pt --device 0 --cfg /content/gdrive/MyDrive/MLFABRIC/MY_YOLO/yolov9/yolov9/models/detect/yolov9_custom.yaml



"""## **Inference with Custom Model**"""

!python detect.py --img 1280 --conf 0.1 --device 0 --weights /content/gdrive/MyDrive/MLFABRIC/MY_YOLO/yolov9/yolov9/runs/train/exp/weights/best.pt --source /content/gdrive/MyDrive/MLFABRIC/yolov8/valid/images

from IPython.display import Image

Image(filename=f"/content/gdrive/MyDrive/MLFABRIC/MY_YOLO/yolov9/yolov9/runs/detect/exp7/1.jpg", width=1000)